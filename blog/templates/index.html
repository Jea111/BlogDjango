{% extends 'layout/navbar.html' %} {% load static %} {% block title %}
Blog-Tienda {% endblock %} {% block content %}

<style>
  .position-relative:hover .opacity-0 {
    opacity: 1 !important;
  }

  #btnCarrito {
    z-index: 1050;
  }

  @media (max-width: 768px) {
    #btnCarrito {
      bottom: 1rem;
      right: 1rem;
      padding: 0.6rem 1rem;
      font-size: 0.9rem;
    }
  }
</style>
<div
  id="carouselExampleFade"
  class="carousel slide carousel-fade"
  data-aos="zoom-in-down"
  data-aos-duration="3000"
>
  <div class="carousel-inner" id="inicio">
    <div class="carousel-item active position-relative">
      <img
        src="/media/media/hero-img.webp"
        class="d-block w-100"
        alt="Hero principal"
        style="max-height: 500px; object-fit: cover"
      />
    </div>

    <div class="carousel-item">
      <img
        src="/media/media/portada-gabo.jfif"
        class="d-block w-100"
        alt="Portada Gabriel García Márquez"
        style="max-height: 500px; object-fit: contain"
      />
      <div
        class="position-absolute top-50 start-50 translate-middle text-center text-white p-4"
        style="background: rgba(0, 0, 0, 0.4); border-radius: 10px"
      >
        <h1 class="fw-bold display-6">Libreria</h1>
        <p class="lead mb-0">
          Un espacio para descubrir, aprender y dejar volar tu imaginación.
        </p>
      </div>
    </div>
  </div>

  <button
    class="carousel-control-prev"
    type="button"
    data-bs-target="#carouselExampleFade"
    data-bs-slide="prev"
  >
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Anterior</span>
  </button>
  <button
    class="carousel-control-next"
    type="button"
    data-bs-target="#carouselExampleFade"
    data-bs-slide="next"
  >
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Siguiente</span>
  </button>
</div>

<button
  id="btnCarrito"
  class="btn btn-success position-fixed bottom-0 end-0 m-4 shadow-lg"
  data-bs-toggle="offcanvas"
  data-bs-target="#offcanvasCart"
  style="z-index: 1050"
>
  <i class="bi bi-cart3 fs-5"></i> Carrito
</button>

<div
  class="offcanvas offcanvas-end"
  tabindex="-1"
  id="offcanvasCart"
  aria-labelledby="offcanvasCartLabel"
>
  <div class="offcanvas-header bg-success text-white">
    <h5 class="offcanvas-title" id="offcanvasCartLabel">Tu Carrito</h5>
    <button
      type="button"
      class="btn-close btn-close-white"
      data-bs-dismiss="offcanvas"
    ></button>
  </div>
  <div class="offcanvas-body">
    <div id="carrito" class="mb-3"></div>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-md-4 mt-4 mb-4 g-4 p-4"></div>

    <div
      class="d-flex flex-wrap justify-content-center gap-4 mb-sm-5 mt-sm-5 pt-sm-3 pb-sm-3"
      data-aos="zoom-out-up"
      data-aos-duration="3000"
    >
      {% for b in blogs_all %}
      <div
        class="card shadow-sm border-0 position-relative overflow-hidden"
        style="width: 20rem"
      >
        {% if b.disponible %}
        <span class="badge bg-success rounded-pill d-block mx-auto"
          >Disponible</span
        >
        {% else %}
        <span class="badge bg-danger rounded-pill d-block mx-auto"
          >Agotado</span
        >
        {% endif %}

        <div class="position-relative">
          {% if b.portada %}
          <img
            src="{{ b.portada.url }}"
            class="card-img img-fluid"
            alt="{{ b.titulo }}"
            style="height: 200px; object-fit: contain"
          />
          {% else %}
          <img
            src="{% static 'img/default.jpg' %}"
            class="card-img-top img-fluid"
            alt="Sin portada"
            style="height: 200px; object-fit: contain"
          />
          {% endif %}

          <div
            class="position-absolute top-0 start-0 w-100 h-100 bg-dark bg-opacity-75 text-white d-flex align-items-center justify-content-center text-center p-3 opacity-0"
            style="transition: opacity 0.4s; pointer-events: none"
          >
            <p class="mb-0 small">{{ b.detalle }}</p>
          </div>
        </div>

        <div class="card-body">
          <h4 class="card-title text-center text-uppercase text-success mb-3">
            {{ b.titulo }}
          </h4>
          <p class="card-text text-center mb-2 text-capitalize text-bg-dark|">
            <span class="badge bg-success">Autor</span><br />
            {{ b.autor }}
          </p>
          <span class="text-muted text-end precioProducto">{{ b.precio }}</span>
          <p class="text-muted small text-center visually-hidden">
            {{ b.fecha }}
          </p>
          {% if b.disponible %}
          <div class="d-grid mt-3">
            <button
              class="btn btn-outline-success w-100 add_to_cart alertBtn"
              data-producto="{{ b.titulo }}"
            >
              <i class="bi bi-cart-plus"></i> Agregar al carrito
            </button>
          </div>
          <div class="d-grid mt-3">
            <a
              href="{% url 'blog_comentado' b.id %}"
              class="btn btn-outline-info btn-sm rounded-pill fw-semibold"
            >
              <i class="bi bi-chat-dots me-1"></i> Ver reseñas
            </a>
          </div>
          {% else %}
          <div class="d-grid mt-3">
            <button
              class="btn btn-success rounded-pill add_to_cart visually-hidden"
            >
              <ion-icon name="cart"></ion-icon>
            </button>
          </div>
          {% endif %}
        </div>
      </div>
      {% empty %}
      <p class="text-center text-muted">No hay blogs disponibles.</p>
      {% endfor %}
    </div>

    <div class="container my-5">
      <div class="row g-4 align-items-center">
        <div class="col-lg-4" id="about">
          <div class="card shadow-lg border-0 rounded-4">
            <div class="card-body p-4">
              <h3 class="text-center text-success mb-4 text-uppercase fw-bold">
                Sobre Nosotros
              </h3>
              <hr />
              <p>
                Somos una librería ubicada en Medellín, dedicada a compartir el
                amor por la lectura y el conocimiento. Ofrecemos una amplia
                selección de libros de distintos géneros, desde literatura
                clásica hasta las últimas novedades. Nuestro propósito es crear
                un espacio donde cada lector encuentre inspiración, aprendizaje
                y nuevas historias por descubrir.
              </p>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3966.1220957127575!2d-75.56839022592084!3d6.247637593740738!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e4429d444104df7%3A0x591da3490ca09224!2sLa%20Librer%C3%ADa!5e0!3m2!1sen!2sco!4v1761242506672!5m2!1sen!2sco"
              width="100%"
              height="350"
              style="border: 0"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
            ></iframe>
          </div>
        </div>

        <div class="col-lg-4" id="calificaciones">
          <div class="card shadow-lg border-0 rounded-4 h-100">
            <div class="card-body p-4">
              {% if mensaje %}
              <div class="alert alert-warning text-center py-2 mb-3">
                {{ mensaje }}
              </div>
              {% endif %}
              <h5 class="text-muted mb-3 text-center">
                <i class="bi bi-chat-left-text text-success"></i> Últimas
                reseñas
              </h5>
              <ul class="list-group list-group-flush">
                {% for r in reseñas %}
                <li class="list-group-item border-0 border-bottom">
                  <div>
                    <strong class="text-success">{{ r.usuario.nombre }}</strong>
                    <div class="text-warning small">
                      <strong>{{r.calificacion_tienda}}</strong>
                      <i class="bi bi-star"></i>
                    </div>
                    <p class="mb-1 mt-2 text-secondary">
                      {{ r.comentario_tienda }}
                    </p>
                    <small class="text-muted d-block">
                      <i class="bi bi-calendar3"></i>
                      {{ r.created_at|date:"d/m/Y H:i" }}
                    </small>
                  </div>
                </li>
                {% empty %}
                <li class="list-group-item text-center text-muted">
                  Aún no hay reseñas.
                </li>
              </ul>

              {% endfor %}

              <div class="d-grid mt-3">
                <a
                  href="{% url 'reseñas_tienda'  %}"
                  class="btn btn-outline-info btn-sm rounded-pill fw-semibold"
                >
                  <i class="bi bi-chat-dots me-1"></i> dejar reseña
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script
  type="module"
  src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
></script>
<link
  rel="stylesheet"
  type="text/css"
  href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
/>
<script
  type="text/javascript"
  src="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.js"
></script>
<script
  nomodule
  src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
></script>
<script src="{% static 'js/script.js' %}"></script>
{% endblock %}
